extends layout

block content
  #fb-root
  script
    // Googple Plus One
    (function() { var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true; po.src = 'https://apis.google.com/js/plusone.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s); })();
    // Facebook Like
    (function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) {return;} js = d.createElement(s); js.id = id; js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=273726349334428"; fjs.parentNode.insertBefore(js, fjs); }(document, 'script', 'facebook-jssdk'));
    // Twitter Share Button
    (function() { var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = '//platform.twitter.com/widgets.js'; var s0 = document.getElementsByTagName('script')[0]; s0.parentNode.insertBefore(s, s0); })();
  header
    h1
      img(src="/images/logo.png", alt="Tttrio - A fast real-time multiplayer pattern-matching game to hone your logical skills" )
    h2 Game #{game.id}
  nav
    div
      button(class="how-to-play-btn") How to Play
  .background-container
    .sky
    .moon
    .cloud-1
    .cloud-2
    .cloud-3
    .outer-container
      article
        .balloons
        #game-container
          .cards-in-play
          .players-container
        #chat
          form.chat-form
            input.sender(type="hidden")
            label Chat: 
            input.msg(type="text", placeholder="Start typing here...")
          ul.chat-msgs
        .share-widgets
          .share-widget.fb-like-container
            .fb-like(data-send="true", data-width="300", data-show-faces="true")
          .share-widget.g-plusone-container
            .g-plusone(data-annotation="inline", data-width="300")
          .share-widget.twitter-share-button-container
            a(href="https://twitter.com/share", class="twitter-share-button", data-count="horizontal") Tweet
        footer Made by
          a(href="http://www.lorenyu.com", target="_blank") Loren Yu
  .game-end-overlay-container
    .game-end-overlay(style="display:none;" )
      ol(class="winners")
        li.winner.champion
          span.name
          | wins with
          span.score
          | points!
        li.winner.runner-up.first
          span.name
          | is runner up with
          span(class="score")
          | points!
        li.winner.runner-up.second
          span(class="name")
          | is second runner up with
          span(class="score")
          | points!
      button(class="close") Close
  .name-form-overlay-container
    .name-form-overlay
      h3
        img(src="/images/logo.png", alt="Tttrio - A fast real-time multiplayer pattern-matching game to hone your logical skills")
      h4 A fast real-time multiplayer pattern-matching game to hone your logical skills
      form(id="name-change-form", action="" )
        label(for="name-field") Name
        input(type="text", id="name-field", name="name", value="", placeholder="Enter Name" )
        br
        button#change-name-btn(type="submit") Enter
  .instructions-overlay-container(title="How to Play")
  script
    $(document).ready(function() {
      var jade = require('jade');
      var pageRenderer = jade.compile($('#page-view').text());
      
      $('.instructions-overlay-container').html(jade.compile($('#instructions-view').text()).call());
      $('.instructions').tabs();
      $("#instructions-rules").accordion({ animated: false, header: "h3" });
      $("#instructions-game-controls").accordion({ animated: false, autoHeight: false, header: "h3" });
      $('.instructions-overlay-container').dialog({
          autoOpen: false,
          draggable: false,
          resizable: false,
          position: ['center', 'top'],
          width: '100%',
          buttons: {
              'Close': function() {
                  $(this).dialog('close');
              }
          }
      });
      $('.how-to-play-btn').click(function() {
          $('.instructions-overlay-container').dialog('open');
      });

      var gameId = #{game.id};

      var eventEngine = new EventEngine();
      $('#chat').chat(eventEngine);
      new EventEngineHttpClient(eventEngine, {
        onInitialized: function() {
          var game = new Game(eventEngine);
        }
      });

      eventEngine.observeAll(function(event) {
        log('received event:' + event.name + ', data=' + JSON.stringify(event.data));
      });
      
    });
  script#page-view.jade(type="text/jade")
    .outer-container
      .sky
      .moon
      .cloud-1
      .cloud-2
      .cloud-3
      #game-container
        .game-controls
          button#restart-game-btn Restart Game (
            span.num-requests 0
            | )
          button#draw-cards-btn Restart Game (
            span.num-requests 0
            | )
      .cards-in-play-container
      form#name-change-form(action="")
        input#name-field(type="text", name="name", value="")
        button#change-name-btn(type="submit") Change Name
      .players-container
      #chat
        form.chat-form
          input.sender(type="hidden")
          input.msg(type="text", placeholder="Chat Away...")
        ul.chat-msgs
      .game-end-overlay-container
      .game-end-overlay(style="display:none;")
        ol.winners
          li.winner.champion
            span.name
            |  wins with 
            span.score
            |  points!
          li.winner.runner-up.first
            span.name
            |  is runner up with
            span.score
            |  points!
          li.winner.runner-up.second
            span.name
            |  is second runner up with 
            span.score
            |  points!
        button.close Close
      #tmp